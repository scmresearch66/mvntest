node {
  checkout scm

  try {
    stage 'Clean up'
    def mvnHome = tool 'M3'
    sh "cd my-app && ${mvnHome}/bin/mvn package" 
  }
  finally {
    stage 'Collect test reports'
    step([$class: 'JUnitResultArchiver', testResults: '**/target/surefire-reports/*.xml'])
  }
}
